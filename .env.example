# =============================================================================
# VALIDATION PORTAL - Environment Configuration Template
# =============================================================================
# Copy this file to .env and fill in your values
# Never commit .env to git!

# -----------------------------------------------------------------------------
# Database Configuration (Required)
# -----------------------------------------------------------------------------
# MongoDB connection string to the validation cluster
MONGODB_VALIDATION_URI=mongodb+srv://[username]:[password]@validation.mongodb.net/?appName=validation

# Database name: use 'validation-dev' for development, 'validation-prod' for production
MONGODB_VALIDATION_DB=validation-prod

# -----------------------------------------------------------------------------
# KoboToolbox Configuration (Stored per-survey in MongoDB)
# -----------------------------------------------------------------------------
# NOTE: KoboToolbox configuration is now stored in the MongoDB 'surveys' collection.
# Each survey has its own kobo_config with API URL and token.
# See CLAUDE.md for details on multi-survey architecture.
#
# To configure KoboToolbox for your surveys:
#   - Run: node scripts/update_single_survey.R
#   - Or batch update: node scripts/update_all_surveys.R
#
# Legacy variables (no longer used):
# KOBO_API_URL=https://eu.kobotoolbox.org/api/v2
# KOBO_API_TOKEN=your_kobo_api_token_here
# KOBO_ASSET_ID=your_primary_asset_id

# -----------------------------------------------------------------------------
# Server Configuration (Optional)
# -----------------------------------------------------------------------------
# Backend server port (default: 3001)
PORT=3001

# Node environment: development or production (affects CORS behavior)
NODE_ENV=development

# -----------------------------------------------------------------------------
# Security Configuration (CRITICAL for Production)
# -----------------------------------------------------------------------------
# JWT Secret Key - MUST be set to a secure random string in production
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=change-this-to-a-secure-random-string-in-production

# JWT Token Expiry (default: 7d)
# Examples: 1h, 24h, 7d, 30d
JWT_EXPIRY=7d

# -----------------------------------------------------------------------------
# AWS SES Configuration (Password Reset Emails)
# -----------------------------------------------------------------------------
# AWS Credentials - Required for sending password reset emails
# Get from AWS IAM Console ‚Üí Users ‚Üí Security Credentials ‚Üí Access Keys
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_REGION=us-east-1

# SES Sender Configuration
# Email must be verified in AWS SES Console ‚Üí Verified Identities
AWS_SES_FROM_EMAIL=noreply@your-domain.com
AWS_SES_FROM_NAME="Peskas Validation Portal"

# Password Reset Configuration
# Dev: http://localhost:3000/reset-password
# Prod: https://your-app.vercel.app/reset-password
PASSWORD_RESET_URL=http://localhost:3000/reset-password
PASSWORD_RESET_TOKEN_EXPIRY=3600  # Token expiry in seconds (3600 = 1 hour)
PASSWORD_RESET_MAX_REQUESTS=3     # Max requests per user per 24h

# -----------------------------------------------------------------------------
# CORS Configuration (Auto-configured)
# -----------------------------------------------------------------------------
# Development: All origins allowed automatically
# Production: *.vercel.app domains allowed automatically
#
# Only set ALLOWED_ORIGINS if you need additional custom domains:
# ALLOWED_ORIGINS=https://your-custom-domain.com,https://another-domain.com

# -----------------------------------------------------------------------------
# User Management
# -----------------------------------------------------------------------------
# Users are stored in MongoDB (users collection)
# To create your first admin user, run:
#   node scripts/create_first_admin.js
# Or use the quick command:
#   node scripts/create_admin_simple.js username email password

# -----------------------------------------------------------------------------
# Frontend Configuration (for Production/Vercel)
# -----------------------------------------------------------------------------
# Production API URL - use relative path for Vercel serverless functions
VITE_API_URL=/api

# -----------------------------------------------------------------------------
# Airtable Integration (Optional - for user/survey syncing)
# -----------------------------------------------------------------------------
# Airtable API configuration (optional, only needed if syncing from Airtable)
# AIRTABLE_API_KEY=your_airtable_personal_access_token
# AIRTABLE_BASE_ID=your_airtable_base_id

# -----------------------------------------------------------------------------
# üöÄ VERCEL DEPLOYMENT - Required Environment Variables
# -----------------------------------------------------------------------------
# Set these in Vercel Dashboard: Project Settings ‚Üí Environment Variables
#
# ‚úÖ CRITICAL (Required for portal to work):
#   MONGODB_VALIDATION_URI=mongodb+srv://username:password@cluster.mongodb.net/?retryWrites=true&w=majority
#   MONGODB_VALIDATION_DB=validation-prod
#   JWT_SECRET=<generate-with-command-above>
#   NODE_ENV=production
#
# üìù RECOMMENDED (Optional):
#   JWT_EXPIRY=7d
#
# üîê AWS SES (Required for password reset):
#   AWS_ACCESS_KEY_ID=<your-aws-access-key>
#   AWS_SECRET_ACCESS_KEY=<your-aws-secret-key>
#   AWS_REGION=us-east-1
#   AWS_SES_FROM_EMAIL=noreply@your-domain.com
#   AWS_SES_FROM_NAME="Peskas Validation Portal"
#   PASSWORD_RESET_URL=https://your-app.vercel.app/reset-password
#   PASSWORD_RESET_TOKEN_EXPIRY=3600
#   PASSWORD_RESET_MAX_REQUESTS=3
#
# üîß OPTIONAL (Only if using Airtable sync):
#   AIRTABLE_TOKEN=<your-airtable-pat>
#   AIRTABLE_BASE_ID=<your-base-id>
#
# üìå IMPORTANT NOTES:
# 1. Generate JWT_SECRET with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# 2. Get MONGODB_VALIDATION_URI from MongoDB Atlas ‚Üí Connect ‚Üí Drivers
# 3. CORS is auto-configured (*.vercel.app domains allowed in production)
# 4. KoboToolbox config is stored in MongoDB (surveys collection), not env vars
# 5. After deployment, verify all 4 critical variables are set in Vercel dashboard
